from libs import * 
sys.path.insert(1, '/homecentral/alexandre.mahrach/gdrive/postdoc_IDIBAPS/python/data_analysis') 

import data.constants as gv 
import data.utils as data 

import plotting as plot 

def angle_epochs(X_proj, IF_SHUFFLE=0):
    
    clf = LogisticRegression(C=1, solver='liblinear', penalty='l2',tol=1e-6, max_iter=int(1e6)) 
    clf = LinearDiscriminantAnalysis() 
    # clf = LinearDiscriminantAnalysis(solver='eigen',shrinkage='auto') 
    gv.epochs = ['ED','MD','LD'] 

    for i, gv.trial in enumerate(gv.trials): 
        X_S1_trials = X_proj[i,0] 
        X_S2_trials = X_proj[i,1] 
        X_trials, y_trials = data.get_X_y_epochs(X_S1_trials, X_S2_trials) 
        print('X', X_trials.shape,'y', y_trials.shape) 
        coefs = coefs_clf(X_trials, y_trials, clf=clf) 

        print('coefs', coefs.shape) 
        alpha, cos_alp = get_cos(coefs) 
        print('trial', gv.trial, 'cos_alp', cos_alp) 
